<div class="row row-xs clearfix mg-0 pd-0 ">
    <div class="col-lg-2 p-2">
        <div class="flex-fill pd-1 pt-2">
            <nav class="nav flex-column  ">
                <div class="d-flex align-items-center justify-content-between pb-1 pt-1">
                    <a [routerLink]="['mon-espace']" routerLinkActive="active" class="nav-link3 tx-echos1"><i
                            class="fas fa-home tx-20 pr-2"></i>
                        Acceuil</a>
                </div>
                <div class="d-flex align-items-center justify-content-between pb-1 pt-1">
                    <a href="#" data-toggle="pill" class="nav-link3 tx-echos1"><i
                            class="fas fa-download tx-20 pr-2"></i> Téléchargements</a>
                </div>
                <div class="d-flex align-items-center justify-content-between pb-1 pt-1">
                    <a href="#" data-toggle="pill" class="nav-link3 tx-echos1"><i
                            class="fas fa-file-alt tx-20 pr-2"></i> Fichiers</a>
                </div>
                <div class="d-flex align-items-center justify-content-between pb-1 pt-1">
                    <a [routerLink]="['mes-partages']" routerLinkActive="active" class="nav-link3 tx-echos1"><i
                            class="fas fa-folder-upload tx-20 pr-2"></i> Partager</a>
                </div>
                <div class="d-flex align-items-center justify-content-between pb-1 pt-1">
                    <a [routerLink]="['mes-partages']" routerLinkActive="active" class="nav-link3 tx-echos1"><i
                            class="fas fa-folder-download tx-20 pr-2"></i> Partagés avec moi</a>
                </div>
                <div class="d-flex align-items-center justify-content-between pb-1 pt-1 ">
                    <a [routerLink]="['favoris']" routerLinkActive="active" class="nav-link3 tx-echos1"><i
                            class="fas fa-star tx-20 pr-2"></i>
                        Favoris</a>
                </div>
                <div class="d-flex align-items-center justify-content-between pb-1 pt-1 ">
                    <a href="#" data-toggle="pill" class="nav-link3 tx-echos1"><i
                            class="fas fa-calendar-alt tx-20 pr-2"></i> Recents</a>
                </div>
                <div class="d-flex align-items-center justify-content-between pb-1 pt-1 ">
                    <a href="#" data-toggle="pill" class="nav-link3 tx-echos1"><i
                            class="fas fa-compress-arrows-alt tx-20 pr-2"></i> Demander</a>
                </div>
                <div class="d-flex align-items-center justify-content-between pb-1 pt-1 ">
                    <a href="#" data-toggle="pill" class="nav-link3 tx-echos1"><i
                            class="fas fa-eye-slash tx-16 pr-2"></i> Confidentieles</a>
                </div>
            </nav>
        </div>

        <div class="flex-fill pd-1  bd-t bd-2"
            *ngIf="allUserStructures && allUserStructures.length; else structureServiceLink">
            <nav class="nav flex-column ">
                <div *ngFor="let structure of allUserStructures"
                    class="d-flex align-items-center justify-content-between pb-1 pt-1 ">
                    <a [routerLink]="['structure', structure.id]" routerLinkActive="active" class="nav-link3"><i
                            class="fal  fa-chart-network tx-indigo tx-20 pr-2"></i> {{structure.cigle}}</a>
                </div>
            </nav>
        </div>

        <div class="flex-fill pd-1  bd-t bd-2">
            <nav class="nav flex-column  ">
                <div class="d-flex align-items-center justify-content-between pb-1 pt-1 "
                    *ngFor="let type of allTypeFichiers">
                    <a [routerLink]="['type', type.id]" routerLinkActive="active" class="nav-link3"><i
                            class="{{type.icon}} tx-20 pr-2"></i> {{type.libelle | titlecase}}</a>
                </div>


            </nav>
        </div>
    </div>
    <div class="col-lg-10" style="background: #f5f5f4;">
        <router-outlet></router-outlet>
    </div>
    <div class="col-lg-3">
        <div class="">
            <app-sidebar></app-sidebar>
        </div>
    </div>
</div>

<div class="card mt-4" style="width: 26rem;">
    <img src="http://localhost:8000/storage/document/2022/January/SVWY7Mmgeu462cIF4xoCfbDsRWXOtQX8R47HKchq.jpg"
        class="card-img-top" alt="...">
    <div class="card-body">
        <button class="btn btn-oblong btn-outline-primary bd-0 btn-icon mx-1">
            <i class="fal fa-trash-alt tx-14 rounded-circle"></i>
        </button>
        <button class="btn btn-oblong btn-outline-primary bd-0 btn-icon mx-1">
            <i class="fal fa-download tx-14 rounded-circle"></i>
        </button>
        <button class="btn btn-oblong btn-outline-primary bd-0 btn-icon mx-1">
            <i class="fal fa-comment tx-14 rounded-circle"></i>
        </button>
        <button class="btn btn-oblong btn-outline-primary bd-0 btn-icon mx-1">
            <i class="fal fa-share-alt tx-14 rounded-circle"></i>
        </button>
        <button class="btn btn-oblong btn-outline-primary bd-0 btn-icon mx-1">
            <i class="fal fa-edit tx-14 rounded-circle"></i>
        </button>
        <button class="btn btn-oblong btn-outline-primary bd-0 btn-icon mx-1">
            <i class="fal fa-star tx-14 rounded-circle"></i>
        </button>
        <button class="btn btn-oblong btn-outline-primary bd-0 btn-icon mx-1">
            <i class="fal fa-eye-slash tx-14 rounded-circle"></i>
        </button>
        <button class="btn btn-oblong btn-outline-primary bd-0 btn-icon mx-1">
            <i class="fal fa-key tx-14 rounded-circle"></i>
        </button>
        <button class="btn btn-oblong btn-outline-primary bd-0 btn-icon mx-1">
            <i class="fal fa-sort-alt tx-14 rounded-circle"></i>
        </button>
    </div>
</div>
<ng-template #structureServiceLink>
    <a [routerLink]="['structure']" class="list-group-item  d-flex align-items-center pt-2 pb-2">
        <i class="fal  fa-chart-network tx-indigo mr-4 list-group-icon "></i> Structures et services
    </a>
</ng-template>

<div style="position: fixed;
width: -webkit-fill-available;
width: -moz-available;
bottom: 0;
right: 0;" *ngIf="(compressingFiles.length || fichierRecent.length) && !isHidden">
    <div class="d-flex justify-content-end scrollable lower-modal">
        <div [ngClass]="isCollapsed  ? 'col-12 col-md-6 col-lg-4 col-xl-4 d-flex' : 'col-12 col-md-6'">
            <div class="card w-100 card-shadow-3">
                <div class="card-header bg-soft-primary w-100 h-100" [class.align-self-end]="checkLength()">
                    <ng-container *ngIf="!checkLength()">
                        <h6 class="card-header-title">
                            {{checkCompletedLength()}} chargement complet
                        </h6>
                        <div class="card-header-btn">
                            <a  (click)="collapse.toggle()" class="btn card-expand mx-2"  title=""><i class="ion-android-expand"></i></a>
                            <a (click)="onCloseDowloadPreview()"  class="btn card-remove mx-2"><i class="ion-android-close text-danger"></i></a>
                        </div>
                    </ng-container>
                    
                    <div class="w-100" *ngIf="checkLength()" (click)="collapse.toggle()">
                        <div class="d-flex justify-content-between" *ngIf="fichierRecent.length">
                            <h6 class="tx-uppercase tx-12 mg-b-0 tx-gray-500">{{checkSize() && checkProgress() ? ( ((checkSize()*checkProgress())/100) | formatFileSize) : 0}} / {{checkSize() | formatFileSize}}</h6>
                            <span class="tx-12 tx-gray-500">
                                {{checkProgress()}}%
                            </span>
                         </div>
                         <div class="d-flex align-items-end justify-content-between mg-b-5">
                            <h5 class="mg-b-0 tx-dark tx-rubik tx-normal"><span class="counter">{{checkLength()}} fichiers en chargement</span></h5>
                            <div class="d-flex align-items-center tx-gray-600">
                              <button class="btn btn-link" 
                              [attr.aria-expanded]="!isCollapsed"> <i class="fa fa-minus-square"></i></button>                                      
                            </div>
                         </div>
                         <div class="progress ht-3 mg-b-0 op-5">
                            <div class="progress-bar" role="progressbar" [style.width]="checkProgress()+'%'" aria-valuenow="26" aria-valuenow="10" aria-valuemin="0" aria-valuemax="100"></div>
                         </div>
                    </div>
                </div>
                <div class="card-body bg-light py-0 scrollable-y-65 scroll-11" #collapse="ngbCollapse" autofocus
                    [(ngbCollapse)]="isCollapsed" style="position: relative; height: 400px">
                    <div class="col-12 mt-2" *ngFor="let item of compressingFiles">
                        <div class="card" *ngIf="item.upload | async as upload">
                            <div class="card-body w-100">
                                <div class="d-flex justify-content-between">
                                    <h6 class="tx-uppercase tx-12 mg-b-0 tx-gray-500">Preparation du téléchargement</h6>
                                    <span class="tx-12 tx-gray-500">{{upload ? upload.progress+'%' : 'terminé' }}</span>
                                    </div>
                                    <div class="d-flex align-items-end justify-content-between mg-b-5">
                                    <h6 class="mg-b-0 tx-dark tx-rubik tx-normal"><span class="counter">Compression des fichiers</span></h6>
                                    <div class="d-flex align-items-center tx-gray-600">
                                        <button class="btn btn-link py-0" *ngIf="!(upload && upload.state != 'DONE')"> <i class="fa fa-check-circle text-success"></i></button>   
                                        <ng-container *ngIf="upload">
                                        <button class="btn btn-link py-0" *ngIf="upload.state == 'IN_PROGRESS'"> <i class="fad fa-spinner-third fa-spin"></i></button>                    
                                        <button class="btn btn-link py-0 btn-link-danger" *ngIf="upload.state == 'IN_PROGRESS'"(click)="item.upload.unsubscribe()"> <i class="fa fa-times"></i></button>                    
                                        </ng-container>
                                    </div>
                                    </div>
                                    <div class="progress ht-3 mg-b-0 op-5">
                                    <div class="progress-bar" [class.bg-danger]="(upload &&!upload.state)" [class.bg-success]="!(upload && upload.state != 'DONE')" role="progressbar" [style.width]="upload ? upload.progress+'%' : '100%'" aria-valuenow="26" aria-valuenow="10" aria-valuemin="0" aria-valuemax="100"></div>
                                    </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-12 mt-2" *ngFor="let item of fichierRecent">
                        <div class="card">
                            <div class="card-body w-100">
                                <div class="d-flex justify-content-between">
                                    <h6 class="tx-uppercase tx-12 mg-b-0 tx-gray-500">{{item.size && item.upload && item.upload.progress ? ( ((item.size*item.upload.progress)/100) | formatFileSize) : 0}}/{{ item.size | formatFileSize}}</h6>
                                    <span class="tx-12 tx-gray-500">{{item.upload ? item.upload.progress+'%' : 'terminé' }}</span>
                                    </div>
                                    <div class="d-flex align-items-end justify-content-between mg-b-5">
                                    <h6 class="mg-b-0 tx-dark tx-rubik tx-normal" style="overflow: auto;"><span class="counter">{{item.libelle}}</span></h6>
                                    <div class="d-flex align-items-center tx-gray-600">
                                        <button class="btn btn-link py-0" *ngIf="!(item.upload && item.upload.state != 'DONE')"> <i class="fa fa-check-circle text-success"></i></button>   
                                        <ng-container *ngIf="item.upload">
                                        <button class="btn btn-link py-0" *ngIf="!item.upload.state" (click)="this.item.retryRequest();"> <i class="fa fa-redo"></i></button>                    
                                        <button class="btn btn-link py-0" *ngIf="item.upload.state == 'IN_PROGRESS'"> <i class="fad fa-spinner-third fa-spin"></i></button>                    
                                        <button class="btn btn-link py-0 btn-link-danger" *ngIf="item.upload.state == 'IN_PROGRESS'"(click)="this.item.cancelSubscription()"> <i class="fa fa-times"></i></button>                    
                                        </ng-container>
                                    </div>
                                    </div>
                                    <div class="progress ht-3 mg-b-0 op-5">
                                    <div class="progress-bar" [class.bg-danger]="(item.upload &&!item.upload.state)" [class.bg-success]="!(item.upload && item.upload.state != 'DONE')" role="progressbar" [style.width]="item.upload ? item.upload.progress+'%' : '100%'" aria-valuenow="26" aria-valuenow="10" aria-valuemin="0" aria-valuemax="100"></div>
                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>